<html>
    <head>
        <title>room</title>
        <script src="emitter.js"></script>
    </head>
    <body>
        <script>
            var fe = new Emitter();
            var be = new Emitter();

            function initStore(fe) {
                fe.addEventListener("store.updateData", function(event) {
                    fe.dispatchEvent(new Event("screen.render"));
                })
            }

            function initScreen(fe) {
                fe.addEventListener("screen.click", function(event) {
                    fe.dispatchEvent(new Event("delivery.actionDelivery"));
                })
                fe.addEventListener("screen.render", function(event) {
                    console.log('here we render');
                })
            }

            function initDelivery(fe, be) {
                fe.addEventListener("delivery.actionDelivery", function(event) {
                    be.dispatchEvent(new Event("strategy.actionRequest"));
                })

                be.addEventListener("delivery.dataDelivery", function(event) {
                    fe.dispatchEvent(new Event("store.updateData"));
                })
            }

            function initStrategy(be) {
                be.addEventListener("strategy.actionRequest", function(event) {
                   be.dispatchEvent(new Event("archive.saveData"));
                })
            }

            function initArchive(be) {
                be.addEventListener("archive.saveData", function(event) {
                   be.dispatchEvent(new Event("delivery.dataDelivery"));
                })
            }

            initStore(fe);
            initScreen(fe);
            initDelivery(fe, be);
            initStrategy(be);
            initArchive(be);

            fe.dispatchEvent(new Event("screen.click"));
        </script>
    </body>
</html>
